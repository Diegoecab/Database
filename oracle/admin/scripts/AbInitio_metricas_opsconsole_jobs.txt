select b.*, a.jobid, a.updatestamp, a.applicationid, a.jobdefinitionid, a.scheduledstarttime, a.effectivescheduledstarttime, a.runcount,  
a.ispriorrerunjobsucceeded, a.commandline, a.workingdirectory, a.username, a.recfile, a.starttime, a.endtime, a.cpu, a.derivedname,
a.stateenum,
to_char(endtime,'DD-MON-YY HH24:MI:SS') as endtime2,
to_char(starttime,'DD-MON-YY HH24:MI:SS') as starttime2,
round((to_date(to_char(endtime,'DD-MON-YY HH24:MI:SS'),'DD-MON-YY HH24:MI:SS' ) - to_date(to_char(starttime,'DD-MON-YY HH24:MI:SS'),'DD-MON-YY HH24:MI:SS' )) * 1440) elapsed_min,
(select j.value from opsconsole.OPMETRIC h, opsconsole.OPMETRICVALUE j
where 
j.metricid=h.metricid and j.jobid = a.jobid --and  b.metricid in ( 107,105,108,91)
and  j.metricid in ( 107)) as num_records_read,
(select j.value from opsconsole.OPMETRIC h, opsconsole.OPMETRICVALUE j
where 
j.metricid=h.metricid and j.jobid = a.jobid --and  b.metricid in ( 107,105,108,91)
and  j.metricid in ( 116)) as num_records_written
from opsconsole.OPJOB a, opsconsole.OPJOBDEFINITION b
where a.starttime > trunc(sysdate -10) 
and b.jobdefinitionid = a.jobdefinitionid